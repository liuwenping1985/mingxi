<?xml version="1.0" encoding="UTF-8"?>
<sqlcfg>
	<report>
		<ProjectScheduleStatistics>
			<main>
				<subjectReport>
				<![CDATA[
				SELECT s.ID as pro_id, s.PROJECT_NAME as 项目名称,orgmem.NAME as mgr_name, s.BEGINTIME as 开始日期,s.CLOSETIME as 结束日期,	
				s.PROJECT_STATE as 项目状态,s.PROJECT_PROCESS as 项目进度                                                                  		  
				FROM project_summary s LEFT JOIN project_member mem ON (s.ID=mem.PROJECT_ID)                                                        
				LEFT JOIN project_member mgr ON (mem.PROJECT_ID=mgr.PROJECT_ID)                                                                     
				LEFT JOIN org_member orgmem ON orgmem.ID=mgr.MEMBERID                                                                               
				WHERE                                                                                                                                
				(CASE  WHEN :projectStatus=5 THEN 1 when s.PROJECT_STATE = :projectStatus then 1 else 0 END)=1                                                       
				AND (CASE WHEN :selfRole=6 THEN 1 when mem.MEMBER_TYPE=:selfRole  then 1 else 0 END)=1                                                              
				AND mem.MEMBERID=:user_id                                                                          						                      
				AND mgr.MEMBER_TYPE=0                         
				AND s.PROJECT_STATE not in (4)         
				]]>
				</subjectReport>
				<projectName>
				<![CDATA[
				 AND s.PROJECT_NAME like '%'+:projectName+'%'
				 ]]>
				</projectName>
				<projectManager>
				<![CDATA[
				 AND mgr.MEMBER_TYPE=0 AND orgmem.NAME like '%'+:projectManager+'%'
				 ]]>
				 </projectManager>
			</main>
		</ProjectScheduleStatistics>
	</report>
</sqlcfg>